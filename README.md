# Sonechka.OS

**–õ–æ–∫–∞–ª—å–Ω–æ–µ, –æ—Ç–∫–∞–∑–æ—É—Å—Ç–æ–π—á–∏–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è —Ä—É—Ç–∏–Ω–æ–π, –∑–∞–±–æ—Ç–æ–π –æ —Å–µ–±–µ –∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º–∏ —Ä–∏—Ç–º–∞–º–∏**

–í–µ—Ä—Å–∏—è 1.0 ‚Ä¢ 26 –¥–µ–∫–∞–±—Ä—è 2025

## üåü –û–ø–∏—Å–∞–Ω–∏–µ

Sonechka.OS ‚Äî —ç—Ç–æ –ª–æ–∫–∞–ª—å–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–≤—Å–µ–¥–Ω–µ–≤–Ω–æ–π —Ä—É—Ç–∏–Ω–æ–π, –∑–∞–±–æ—Ç–æ–π –æ —Å–µ–±–µ –∏ –∂–∏–∑–Ω–µ–Ω–Ω—ã–º–∏ —Ä–∏—Ç–º–∞–º–∏. –í—Å–µ –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ –Ω–∞ –≤–∞—à–µ–º —É—Å—Ç—Ä–æ–π—Å—Ç–≤–µ, –±–µ–∑ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è —Å–µ—Ä–≤–µ—Ä–æ–≤ –∏–ª–∏ –æ–±–ª–∞—á–Ω—ã—Ö —Å–µ—Ä–≤–∏—Å–æ–≤.

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–∏–Ω—Ü–∏–ø—ã

- **–õ–æ–∫–∞–ª—å–Ω–æ—Å—Ç—å**: –í—Å–µ –¥–∞–Ω–Ω—ã–µ ‚Äî –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ `sonechka.state.json`, –≤—ã–±—Ä–∞–Ω–Ω–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —á–µ—Ä–µ–∑ `showDirectoryPicker()`. –ù–∏–∫–∞–∫–∏—Ö —Å–µ—Ä–≤–µ—Ä–æ–≤.
- **Event Sourcing**: –ï–¥–∏–Ω—Å—Ç–≤–µ–Ω–Ω—ã–π –∏—Å—Ç–æ—á–Ω–∏–∫ –∏—Å—Ç–∏–Ω—ã ‚Äî –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π –º–∞—Å—Å–∏–≤ —Å–æ–±—ã—Ç–∏–π (events). –°–æ—Å—Ç–æ—è–Ω–∏–µ –ø–µ—Ä–µ—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø—Ä–∏ –∑–∞–ø—É—Å–∫–µ.
- **–ñ—ë—Å—Ç–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏**: –®–∞–≥ B –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–∫–∞ –Ω–µ –∑–∞–≤–µ—Ä—à—ë–Ω —à–∞–≥ A (–Ω–∞–ø—Ä.: ¬´–ú–∞–∫–∏—è–∂¬ª –∑–∞–≤–∏—Å–∏—Ç –æ—Ç ¬´–≠—Å—Ç—Ä–æ–∂–µ–ª—è¬ª).
- **–ó–∞–≤–µ—Ä—à—ë–Ω–Ω–æ—Å—Ç—å**: –†–∏—Ç—É–∞–ª = ‚úÖ —Ç–æ–ª—å–∫–æ –µ—Å–ª–∏ –≤—Å–µ —à–∞–≥–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã. –ù–µ–ª—å–∑—è ¬´—á–∞—Å—Ç–∏—á–Ω–æ¬ª.
- **–Ø–∫–æ—Ä—è –≤–º–µ—Å—Ç–æ –æ—Ü–µ–Ω–æ–∫**: –í –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–µ ‚Äî –Ω–µ ¬´7/10¬ª, –∞: ‚úÖ –≠—Å—Ç—Ä–æ–∂–µ–ª—å (—É—Ç—Ä–æ), üíß –ú–æ–Ω—Å—Ç–µ—Ä–∞ ‚Äî –ø—Ä–æ–ø—É—â–µ–Ω–æ.
- **–ê–¥–∞–ø—Ç–∞—Ü–∏—è**: –ü—Ä–∏ –Ω–∏–∑–∫–æ–π –≥–ª—é–∫–æ–∑–µ ‚Äî –Ω–µ —à—Ç—Ä–∞—Ñ, –∞ –ø–µ—Ä–µ–Ω–æ—Å —Å –∫–æ–º–ø–µ–Ω—Å–∞—Ü–∏–µ–π (+5 –º–∏–Ω —É—Ö–æ–¥–∞ –∑–∞–≤—Ç—Ä–∞).
- **–£–≤–∞–∂–µ–Ω–∏–µ –∫ –∂–∏–≤–æ—Ç–Ω—ã–º**: –ù–∏–∫–∞–∫–∏—Ö ¬´–ø–æ—Å—Ç–∞–≤–∏—Ç—å –ì–µ—Ä–¥—É —Ä—è–¥–æ–º¬ª. –ì–µ—Ä–¥–∞/–®–µ—Ä–ª–æ–∫/–õ–æ–∫–∞ ‚Äî —Ç–æ–ª—å–∫–æ –∫–æ–Ω—Ç–µ–∫—Å—Ç (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ).

## üõ† –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

- **Frontend**: TypeScript + Vite + Lit (–ª—ë–≥–∫–∏–π, –±–µ–∑ React)
- **–°–æ—Å—Ç–æ—è–Ω–∏–µ**: AppStateManager –Ω–∞ Proxy + event sourcing
- **–•—Ä–∞–Ω–µ–Ω–∏–µ**: File System Access API + Service Worker (—Ç–µ–Ω–µ–≤–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ)
- **–°–±–æ—Ä–∫–∞**: Vite ‚Üí PWA (manifest.json, sw.js)
- **–¢–µ—Å—Ç—ã**: Jest (unit), Cypress (e2e)

## üöÄ –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –∏ –∑–∞–ø—É—Å–∫

1. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:
   ```bash
   npm install
   ```

2. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏:
   ```bash
   npm run dev
   ```

3. –°–æ–±–µ—Ä–∏—Ç–µ –ø—Ä–æ–µ–∫—Ç:
   ```bash
   npm run build
   ```

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

```
src/
‚îú‚îÄ‚îÄ types.ts                 # –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ AppStateManager.ts       # –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ–º —Å event sourcing
‚îú‚îÄ‚îÄ FileStorage.ts           # –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–æ–≤–æ–π —Å–∏—Å—Ç–µ–º–æ–π
‚îú‚îÄ‚îÄ SonechkaApp.ts           # –ì–ª–∞–≤–Ω—ã–π –∫–ª–∞—Å—Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îú‚îÄ‚îÄ main.ts                  # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îú‚îÄ‚îÄ index.html               # –û—Å–Ω–æ–≤–Ω–æ–π HTML
‚îî‚îÄ‚îÄ ...
```

## üìä –°—Ö–µ–º–∞ –¥–∞–Ω–Ω—ã—Ö

### AppState ‚Äî –∫–æ—Ä–Ω–µ–≤–æ–π –æ–±—ä–µ–∫—Ç
```typescript
interface AppState {
  version: "1.0";
  lastSaved: string; // ISO 8601
  events: Event[];
  meta: {
    userId: string; // UUID v4
    deviceName?: string;
    lastBackup?: string;
  };
}
```

### Event ‚Äî –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–π –∂—É—Ä–Ω–∞–ª
```typescript
type Event =
  | { type: "app_init"; ts: string }
  | { type: "ritual_step_completed"; ts: string; ritualId: string; stepId: string }
  | { type: "med_taken"; ts: string; medId: string; dose?: number }
  | { type: "eye_drop_applied"; ts: string; dropType: "systane" | "emoxipin" | "midramax" }
  | { type: "watering_done"; ts: string; plantId: string }
  | { type: "glucose_measured"; ts: string; value: number }
  | { type: "plant_profile_updated"; ts: string; plantId: string; profile: PlantProfile }
  | { type: "focus_lost"; ts: string }
  | { type: "backup_created"; ts: string; path: string };
```

## üåø –†–∞—Å—Ç–µ–Ω–∏—è

–ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç —É—Ö–æ–¥ –∑–∞ 11 —Ä–∞—Å—Ç–µ–Ω–∏—è–º–∏ —Å —Ä–∞–∑–Ω–æ–π –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å—é:

- –®–µ—Ñ—Ñ–ª–µ—Ä–∞ –ì–µ—Ä–¥–∞
- –®–µ—Ñ—Ñ–ª–µ—Ä–∞ –ù–æ—Ä–∞
- –§–∏–∫—É—Å —ç–ª–∞—Å—Ç–∏–∫–∞
- –ú–æ–Ω—Å—Ç–µ—Ä–∞
- –ù–æ–ª–∏–Ω–∞
- –î—Ä–∞—Ü–µ–Ω–∞
- –ü–µ–ø–µ—Ä–æ–º–∏—è
- –Æ–∫–∫–∞ –±–æ–ª—å—à–∞—è
- –Æ–∫–∫–∞ –º–∞–ª–µ–Ω—å–∫–∞—è
- –§–∏–ª–æ–¥–µ–Ω–¥—Ä–æ–Ω
- –ï–ª—å –∫–æ–Ω–∏–∫–∞ (–≤—ã—Å–æ–∫–∞—è –∫—Ä–∏—Ç–∏—á–Ω–æ—Å—Ç—å!)

## üíä –†–∏—Ç—É–∞–ª—ã

### –ó–¥–æ—Ä–æ–≤—å–µ (–µ–∂–µ–¥–Ω–µ–≤–Ω–æ)
- –£—Ç—Ä–µ–Ω–Ω—è—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- –û–±–µ–¥–µ–Ω–Ω–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞
- –í–µ—á–µ—Ä–Ω—è—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞

### –ó–∞–±–æ—Ç–∞ –æ —Å–µ–±–µ
- –£—Ç—Ä–µ–Ω–Ω–∏–π —É—Ö–æ–¥ –∑–∞ –∫–æ–∂–µ–π
- –ú–∞–∫–∏—è–∂
- –ß–∏—Å—Ç–∫–∞ –∑—É–±–æ–≤
- –í–µ—á–µ—Ä–Ω–∏–π —É—Ö–æ–¥

## üìà –†–∞–∑–≤–∏—Ç–∏–µ –∏ —Ä–∞–±–æ—Ç–∞

–°—á–µ—Ç—á–∏–∫–∏ –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –≤ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –æ–±–ª–∞—Å—Ç—è—Ö:
- –õ–µ–∫—Ü–∏–∏, –ø—Ä–∞–∫—Ç–∏–∫–∞, –∑–æ–æ–ø—Å–∏—Ö–æ–ª–æ–≥–∏—è
- –•—É–¥–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–∞—è –ª–∏—Ç–µ—Ä–∞—Ç—É—Ä–∞
- –ò–∑—É—á–µ–Ω–∏–µ –∞–Ω–≥–ª–∏–π—Å–∫–∏—Ö —Å–ª–æ–≤
- –ú—ã–ª–æ–≤–∞—Ä–µ–Ω–∏–µ
- –†–∞–±–æ—Ç–∞ –∏ –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—á—Ç—ã

## üìÖ –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ

- **–û—Å–Ω–æ–≤–Ω–æ–π —Ñ–∞–π–ª**: `sonechka.state.json` —á–µ—Ä–µ–∑ FileSystemDirectoryHandle
- **–†–µ–∑–µ—Ä–≤–Ω–∞—è –∫–æ–ø–∏—è**: –ï–∂–µ–¥–Ω–µ–≤–Ω–æ: `backups/sonechka_YYYYMMDD.json`
- **–ê–≤—Ç–æ—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ**: –ü—Ä–∏ –ø–æ—Ç–µ—Ä–µ —Ñ–æ–∫—É—Å–∞ –≤–∫–ª–∞–¥–∫–∏ (blur) —Å debounce 1 —Å
- **–û—Ñ–ª–∞–π–Ω-—Ä–µ–∂–∏–º**: –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞: –≤—Å–µ –æ–ø–µ—Ä–∞—Ü–∏–∏ ‚Äî –ª–æ–∫–∞–ª—å–Ω–æ
- **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è**: –ß–µ—Ä–µ–∑ BroadcastChannel –º–µ–∂–¥—É –≤–∫–ª–∞–¥–∫–∞–º–∏

## üèó –≠—Ç–∞–ø—ã —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏

1. **–Ø–¥—Ä–æ (AppState, FileStorage)** - 1 –¥–µ–Ω—å - –†–∞–±–æ—á–µ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ/–∑–∞–≥—Ä—É–∑–∫–∞
2. **–†–∏—Ç—É–∞–ª—ã + –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏** - 1 –¥–µ–Ω—å - UI, –∑–∞–≤–µ—Ä—à—ë–Ω–Ω–æ—Å—Ç—å, –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏
3. **–†–∞—Å—Ç–µ–Ω–∏—è** - 0.5 –¥–Ω—è - –ü—Ä–æ—Ñ–∏–ª–∏, nextDue, riskLevel
4. **–ì–ª—é–∫–æ–∑–∞ –∏ –∞–¥–∞–ø—Ç–∞—Ü–∏—è** - 0.5 –¥–Ω—è - glucose_measured, –ø–µ—Ä–µ–Ω–æ—Å—ã
5. **–ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å** - 1 –¥–µ–Ω—å - –Ø–∫–æ—Ä—è, —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ-—Å—Ç–∞—Ç—É—Å
6. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≥—Ä–∞—Ñ–∏–∫–∞** - 1 –¥–µ–Ω—å - 70+ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –∫–∞–∫ —Ä–∏—Ç—É–∞–ª—ã
7. **–†–µ–∑–µ—Ä–≤–Ω–æ–µ –∫–æ–ø–∏—Ä–æ–≤–∞–Ω–∏–µ** - 0.5 –¥–Ω—è - –ï–∂–µ–¥–Ω–µ–≤–Ω—ã–π –±—ç–∫–∞–ø

–ò—Ç–æ–≥–æ: 5.5 –¥–Ω–µ–π - –ì–æ—Ç–æ–≤–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ

---

*–ü—Ä–æ–µ–∫—Ç Sonechka.OS ‚Ä¢ –°–æ—Ñ—å—è ‚Ä¢ 26.12.2025*